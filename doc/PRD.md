# **App 数据监控与分析平台 - 产品需求文档 (PRD)**

版本: 1.0

最后更新: 2025年8月10日

### **1. 项目背景与目标**

#### **1.1 背景**

随着公司业务的发展，我们需要一个自动化、系统化的方式来监控我们发布在 Apple App Store 和 Google Play Store 上的 App 的关键业务数据。当前，手动登录后台查看数据效率低下，且难以进行持续性的数据追踪和分析。特别是，由于 ASO 等运营活动可能引发流量异常，甚至导致苹果官方警告，建立一套有效的异常波动告警机制迫在眉睫。为了解决这一痛点，我们计划开发一个内部工具，自动化地聚合数据、进行分析，并通过即时通讯工具（Lark）进行通知，从而提高运营和产品团队的决策效率和风险防范能力。

#### **1.2 目标**

* **核心目标**: 实现对指定 App 在两大应用商店核心数据的自动化监控、分析、告警与汇报。  
* **近期目标 (V1.0)**:  
  1. 支持配置多个 App 的监控任务。  
  2. 每日自动从 App Store Connect 和 Google Play Console 拉取关键数据（如新增下载、活跃会话等）。  
  3. 对拉取的数据进行格式化处理和基础分析（如同比、环比变化）。  
  4. **对关键指标的异常波动进行检测并发出告警。**  
  5. 将格式化后的原始数据存入指定的 Lark 表格。  
  6. 将核心分析结果和告警信息通过 Lark 机器人推送到指定群聊。  
* **远期目标 (V2.0+)**:  
  1. 支持更多数据维度（如用户留存、收入、评分评论等）。  
  2. 提供数据可视化图表展示。  
  3. 引入更高级的分析模型（如趋势预测）。  
  4. 支持更多通知渠道（如邮件、短信等）。

### **2. 功能需求 (Features)**

#### **2.1 管理后台模块**

| 功能点 | 优先级 | 详细描述 |
| :---- | :---- | :---- |
| **用户认证** | 高 | （初期可简化）系统管理员登录功能，保护配置信息安全。 |
| **App 列表管理** | 高 | - **添加 App**: 支持录入 App 名称、平台 (iOS/Android)、Bundle ID/Package Name 等基本信息。 - **编辑/删除 App**: 修改 App 配置信息或停止对某个 App 的监控。 |
| **凭证管理** | 高 | - 安全地配置和存储访问 App Store Connect API 所需的 Issuer ID, Key ID, Private Key。 - 安全地配置和存储访问 Google Play API 所需的 Service Account JSON 密钥。 |
| **任务调度配置** | 中 | - 设置数据抓取任务的执行时间（例如：每日上午9点）。 - （可选）提供手动触发任务执行的按钮。 |
| **通知与告警配置** | 高 | - 配置用于接收日常报告的 Lark 群机器人 Webhook 地址。 - 配置用于接收**异常告警**的 Lark 群机器人 Webhook 地址（可与日常报告分开）。 - 配置用于存储数据的 Lark 表格的链接或 ID。 - **配置各指标的告警阈值**（例如：下载量日环比增长超过 200%）。 |

#### **2.2 执行模块 (核心服务)**

| 功能点 | 优先级 | 详细描述 |
| :---- | :---- | :---- |
| **定时任务调度器** | 高 | 基于后台配置的时间，定时触发数据抓取流程。 |
| **数据抓取器** | 高 | - **Apple Store Connect API 适配**: 调用官方 API，获取指定 App 的每日新增下载量、每日活跃会话数等数据。 - **Google Play Console API 适配**: 调用官方 API，获取指定 App 的相应数据。 - **错误处理与重试**: 在 API 请求失败时，具备一定的重试机制和详细的日志记录。 |
| **数据分析引擎** | 高 | - **数据清洗与格式化**: 将从不同平台获取的异构数据，统一为标准格式。 - **基础分析**: 计算关键指标的日环比（DOD）、周同比（WOW）增长率。 - **报告生成**: 生成结构化的文本报告，包含核心数据和分析结果，用于 Lark 通知。 |
| **异常波动检测器** | 高 | - 根据后台配置的阈值规则，对拉取的数据进行判断。 - 当数据超过预设阈值时，立即触发告警机制。 |
| **数据推送器** | 高 | - **Lark 表格写入**: 调用 Lark API，将每日的原始数据追加写入到指定的表格中。 - **Lark 机器人通知**: 调用 Webhook，将分析报告和告警信息发送到指定的 Lark 群聊。 |

#### **2.3 通知模块**

| 功能点 | 优先级 | 详细描述 |
| :---- | :---- | :---- |
| **Lark 日常报告** | 高 | - 消息格式清晰易读，可以采用 Lark 的富文本卡片消息格式。 - 消息内容应包含：监控的 App 名称、数据日期、核心指标（下载、活跃等）及其环比/同比变化。 - 包含指向 Lark 数据表格的链接，方便快速查看原始数据。 |
| **Lark 异常告警** | 高 | - 当检测到数据异常时，**立即**发送专门的告警消息。 - 告警消息应使用醒目的格式（如红色标题），明确指出异常的 App、指标、当前数值以及触发的阈值规则。 - 消息中可 @ 特定负责人，以便快速响应。 |
| **任务状态通知** | 中 | （可选）在任务执行失败时，向管理员或指定群聊发送失败告警。 |

### **3. 非功能性需求**

* **安全性**: 所有 API 密钥、凭证等敏感信息必须加密存储，不能硬编码在代码中。后台管理界面需要有访问控制。  
* **稳定性与及时性**: 执行模块需要保证 7x24 小时稳定运行。**告警通知必须保证高及时性**。  
* **可维护性**: 代码结构清晰，模块化设计，方便后续的功能扩展和维护。关键流程需要有详细的日志记录，便于排查问题。  
* **易用性**: 管理后台的配置流程应简单直观，非技术人员也能轻松上手。